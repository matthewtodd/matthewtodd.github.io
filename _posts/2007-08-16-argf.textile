--- 
wordpress_id: 34
title: ARGF
wordpress_url: http://www.matthewtodd.org/2007/08/16/argf/
layout: post
---
Every few months or so, I get to help email out the <a href="http://www.amanikids.org">Amani</a> newsletters by taking everyone's address books and merging them together. (It's not ideal; requiring unsubscribing to be a manual process makes it all too easy to forget and annoy some people. Changes are afoot.)

Playing with files like this, it's fun to drop to the command line and see how quickly I can get it done. This time around, I remembered Ruby's <code>ARGF</code>, which is a synonym for <code>$<</code>, which clearly came from Perl.

From the <a href="http://www.pragmaticprogrammer.com/titles/ruby">Pickaxe</a>, <code>$<</code> is:

<blockquote>
An object that provides access to the concatenation of all the files given as command-line arguments or <code>$stdin</code> (in the case where there are no arguments). <code>$<</code> supports methods similar to a <code>File</code> object...
</blockquote>

So, here we go:

{% highlight bash %}
ruby -rcsv -e 'CSV::Reader.parse(ARGF) { |row| puts row[4] }' *.csv
  | sort | uniq > final.csv
{% endhighlight %}

In English, that's "loading the <code>csv</code> library, parse the given files (<code>*.csv</code>), printing only column 4 of each <code>row</code>. Sort the results, removing duplicates, and save as <code>final.csv</code>."

I love this stuff.
